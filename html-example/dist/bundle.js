(()=>{function e(t){return e="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},e(t)}function t(e,t){for(var a=0;a<t.length;a++){var i=t[a];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,n(i.key),i)}}function n(t){var n=function(t){if("object"!=e(t)||!t)return t;var n=t[Symbol.toPrimitive];if(void 0!==n){var a=n.call(t,"string");if("object"!=e(a))return a;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(t)}(t);return"symbol"==e(n)?n:n+""}var a=function(){return e=function e(t){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.container=t,this.images=[],this.framesPerAngle=36,this.verticalAngles=10,this.currentFrame=0,this.currentAngle=0,this.isDragging=!1,this.lastMouseX=0,this.lastMouseY=0,this.accumulatedDeltaX=0,this.accumulatedDeltaY=0,this.viewerElement=document.createElement("img"),this.container.appendChild(this.viewerElement),this.addEventListeners(),this.viewerElement.addEventListener("dragstart",(function(e){return e.preventDefault()}))},(n=[{key:"resetViewer",value:function(){this.images=[],this.currentFrame=0,this.currentAngle=0,this.viewerElement.src=""}},{key:"addEventListeners",value:function(){var e=this;this.container.addEventListener("mousedown",(function(t){0===t.button&&(e.isDragging=!0,e.lastMouseX=t.clientX,e.lastMouseY=t.clientY,e.accumulatedDeltaX=0,e.accumulatedDeltaY=0)})),window.addEventListener("mousemove",(function(t){return e.handleDrag(t)})),window.addEventListener("mouseup",(function(){return e.isDragging=!1}))}},{key:"handleDrag",value:function(e){if(this.isDragging){var t=e.clientX-this.lastMouseX,n=e.clientY-this.lastMouseY;if(this.lastMouseX=e.clientX,this.lastMouseY=e.clientY,this.accumulatedDeltaX+=t,Math.abs(this.accumulatedDeltaX)>30){var a=Math.sign(this.accumulatedDeltaX);this.updateHorizontalFrame(a),this.accumulatedDeltaX=0}if(this.accumulatedDeltaY+=n,Math.abs(this.accumulatedDeltaY)>30){var i=Math.sign(this.accumulatedDeltaY);this.updateVerticalAngle(i),this.accumulatedDeltaY=0}}}},{key:"updateHorizontalFrame",value:function(e){var t=this.framesPerAngle;this.currentFrame=(this.currentFrame-e+t)%t,this.updateFrame()}},{key:"updateVerticalAngle",value:function(e){var t=this.verticalAngles;this.currentAngle=(this.currentAngle+e+t)%t,this.updateFrame()}},{key:"updateFrame",value:function(){var e=this.currentAngle*this.framesPerAngle+this.currentFrame;this.images.length>0&&this.images[e]&&(this.viewerElement.src=this.images[e])}},{key:"loadP3DFromData",value:function(e){var t=this;(new JSZip).loadAsync(e).then((function(e){e.forEach((function(e,n){n.name.match(/\.(png|jpg|jpeg)$/i)&&n.async("blob").then((function(e){var n=URL.createObjectURL(e);t.images.push(n),1===t.images.length&&t.updateFrame()}))}))}))}}])&&t(e.prototype,n),Object.defineProperty(e,"prototype",{writable:!1}),e;var e,n}(),i=document.getElementById("uploadSection"),r=document.getElementById("viewerSection"),s=document.getElementById("uploadInput"),u=document.getElementById("backArrow"),l=new a(document.getElementById("viewer"));s.addEventListener("change",(function(e){var t=e.target.files[0];if(t){var n=new FileReader;n.onload=function(e){l.loadP3DFromData(e.target.result),i.classList.remove("active"),r.classList.add("active")},n.readAsArrayBuffer(t)}})),u.addEventListener("click",(function(){r.classList.remove("active"),i.classList.add("active"),l.resetViewer()}))})();